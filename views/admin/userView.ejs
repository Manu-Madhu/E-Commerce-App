<%- include('../partials/header.ejs')%>
    <div class="container-fluid p-0 min-vh-100 " style="margin-top: 7%;">
        <%- include('../partials/adminnav.ejs')%>
            <div class="container f-flex align-items-center justify-content-center">
                <div class="row p-4 gap-3 d-flex justify-content-center">
                    <div class="DashBoardUl container col-md-2 p-0 m-0 bg-white d-flex pt-4 sideBar">
                        <ul class="d-flex flex-column">
                            <li class="dashOther fw-bold p-1 m-2 ps-4 ">
                                <img src="/assets/admin/d1.png" alt="" class="img-fluid me-2">
                                <span><a class="text-decoration-none" style="color: #cdcdcd;"
                                        href="/admin/Dashboard">DashBoard</a></span>
                            </li>
                            <li class="dashOther fw-bold p-1 ps-4 m-2">
                                <img src="/assets/admin/d3.png" alt="" class="img-fluid me-2">
                                <span><a href="/admin/catagory" class="text-decoration-none"
                                        style="color: #cdcdcd;">Category</a></span>
                            </li>
                            <li class="dashOther fw-bold p-1 ps-4 m-2">
                                <img src="/assets/admin/d2.png" alt="" class="img-fluid me-2">
                                <span></span>
                                <a href="/admin/productView" class="text-decoration-none"
                                    style="color: #cdcdcd;">Product</a></span>
                            </li>
                            <li class="sideBarlist p-1 ps-4 m-2">
                                <img src="/assets/admin/d4.png" alt="" class="img-fluid me-2">
                                <span></span>
                                <a href="/admin/coustomers" class="text-decoration-none"
                                    style="color:  white;">Coustomer</a></span>
                            </li>
                            <li class="dashOther fw-bold p-1 ps-4 m-2">
                                <img src="/assets/admin/d5.png" alt="" class="img-fluid me-2">
                                <span></span>
                                <a href="#" class="text-decoration-none" style="color: #cdcdcd;">Order</a></span>
                            </li>
                            <li class="dashOther fw-bold p-1 ps-4 m-2">
                                <img src="/assets/admin/d6.png" alt="" class="img-fluid me-2">
                                <span></span>
                                <a href="#" class="text-decoration-none" style="color: #cdcdcd;">Coupons</a></span>
                            </li>
                            <li class="dashOther fw-bold p-1 ps-4 m-2">
                                <img src="/assets/admin/d2.png" alt="" class="img-fluid me-2">
                                <span></span>
                                <a href="#" class="text-decoration-none" style="color: #cdcdcd;">Banner</a></span>
                            </li>
                            <li class="dashOther fw-bold p-1 ps-4 m-2">
                                <img src="/assets/admin/d6.png" alt="" class="img-fluid me-2">
                                <span></span>
                                <a href="" class="text-decoration-none" style="color: #cdcdcd;">Logout</a></span>
                            </li>
                        </ul>
                    </div>
                    <div class=" container col-md-9  p-0 m-0">
                        <div class="container p-0">
                            <div class="conatiner saleTop bg-white d-flex align-items-center mb-3">
                                <div class="container summary d-flex align-items-center justify-content-between p-4 "
                                    id="product">
                                    <h6 class="p-3 ps-4">Coustomers</h6>
                                    <input type="text" placeholder="User Name, Email, Phone" class="text-center">
                                </div>
                            </div>

                            <div class="container Pa_table bg-white p-2">
                                <div class="container bg-white P_table">
                                    <div class="container p-3 ">
                                        <table class="table">
                                            <thead id="tableHeader">
                                                <tr>
                                                    <th scope="col">ID</th>
                                                    <th scope="col">Name</th>
                                                    <th scope="col">Email</th>
                                                    <!-- <th scope="col">Address</th> -->
                                                    <th scope="col">Phone</th>
                                                    <th scope="col">Action</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                <% userData.forEach((data, index)=>{ %>
                                                    <tr>
                                                        <th scope="row">
                                                            <%= index +1%>
                                                        </th>
                                                        <td scope="col" class="tablefont">
                                                            <h6>
                                                                <%= data.name%>
                                                            </h6>
                                                        </td>
                                                        <td scope="col">
                                                            <span>
                                                                <%= data.email%>
                                                            </span>
                                                        </td>
                                                        <!-- <td scope="col">
                                                            <span><%= data.email%></span>
                                                        </td> -->
                                                        <td scope="col">
                                                            <span>
                                                                <%= data.number%>
                                                            </span>
                                                        </td>
                                                        <td scope="col" class="TableButton">
                                                            <% if(data.isBlocked===false) { %>
                                                                <form action="/admin/userBlocking/<%= data._id %>"
                                                                    method="post" onclick="confirmDelete()">
                                                                    <button class="btn btn-danger text-black"
                                                                        type="submit">Block</button>
                                                                </form>
                                                                <% } else if(data.isBlocked===true) { %>
                                                                    <form action="/admin/userUnBlocking/<%= data._id %>"
                                                                        method="post" onclick="confirmunblock()">
                                                                        <button class="btn btn-success text-white"
                                                                            type="submit">UnBlock</button>
                                                                    </form>
                                                                <% } %>
                                                        </td>
                                                    </tr>
                                                    <% })%>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
    </div>
    </div>

    <script src="/js/alert.js"></script>
    <script>
        // Find the parent container (replace "container" with the appropriate selector)
        const parentContainer = document.querySelector('.toggle-button');
        // Add click event listener to the parent container
        parentContainer.addEventListener('click', function (event) {
            if (event.target.classList.contains('toggle-button')) {
                const button = event.target;
                const userId = button.getAttribute('data-user-id');

                // Check the current state of the button
                const isBlocked = button.classList.contains('blocked');

                // Call the toggleBlock function with the user ID and current state
                toggleBlock(userId, isBlocked, button);
            }
        });

        function toggleBlock(userId, isBlocked, button) {
            // Send AJAX request to the server to toggle the block status

            // Assuming a successful response from the server, update the button state
            if (isBlocked) {
                // Change from blocked to unblocked
                button.textContent = 'Block';
                button.classList.remove('blocked');
            } else {
                // Change from unblocked to blocked
                button.textContent = 'Unblock';
                button.classList.add('blocked');
            }
        }

    </script>

    <%- include('../partials/adminfooter.ejs')%>